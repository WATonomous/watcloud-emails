// This script generates an index file to export all email templates in a single object.
// This is run as a prebuild step.

const fs = require('fs');
const path = require('path');

const emailDir = path.resolve(__dirname, '../src/emails');
const outFile = path.resolve(__dirname, '../src/index.generated.ts');
const files = fs.readdirSync(emailDir)
    .filter(f => f.endsWith('.tsx'))

let code = `// Auto-generated by ${path.basename(__filename)}\n`;
code += `export const Emails: Record<string, any> = {\n`;

for (const file of files) {
    const name = path.basename(file, path.extname(file));
    code += `    "${name}": require('./emails/${name}'),\n`;
}

code += `};\n`;

fs.writeFileSync(outFile, code);